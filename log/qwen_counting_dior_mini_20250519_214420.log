2025-05-19 21:44:20,596 [INFO] Prompt: {
    "Persona": "You are an advanced AI model capable of understanding and analyzing remote sensing images."
    "Task": "Given an input satellite imagery, count the number of objects from specific categories. Provide the results in JSON format where the keys are the category names and the values are the corresponding counts.",
    "Instructions": [
        "The 20 categories in the dataset are: ['airplane', 'airport', 'baseball field', 'basketball court', 'bridge', 'chimney', 'expressway service area', 'expressway toll station', 'dam', 'golf field', 'ground track field', 'harbor', 'overpass', 'ship', 'stadium', 'storage tank', 'tennis court', 'train station', 'vehicle', 'windmill']",
        "The spatial resolution of the images is 0.3m-30m.",
        "Airport is a large area of land where aircraft can take off and land. It includes runways and other facilities. Do not count airport if the it is not compeletely visible in the image.",
        "Harbor is defined as a pier to dock ships. If multiple harbors are visible in the image, count each distinct pier separately.",
        "Expressway toll station is a toll booth at the entrance of the expressway and spans the road.",
        "Expressway service area is a rest area along an expressway. If it exsits on the both sides of the expressway, count them separately.",
        "Overpass is a road crossing over another road. Bridge is a road spanning a river. Distinguish them carefully.",
        "If the overpass or bridge is composed of parallel, separate sections (for example, different lanes or directions of traffic), each section should be counted individually.",
        "Count every ship and vehicle carefully, even the resolution is low and the objects are small and dense.",
        "If none of the objects among the categories is visible, output a JSON object with all categories set to 0"],
    "Output format": "{ "category1": count1, "category2": count2, ... }",
    "Examples": [
        "{ "airplane": 2, "airport": 0, "baseball field": 0, "basketball court": 0, "bridge": 1, ... }",
        "{ "airplane": 0, "airport": 0, "baseball field": 2, "basketball court": 6, "bridge": 0, ... }"]
}
Running on device: cuda:0
2025-05-19 21:44:20,596 [INFO] Image directory: datasets/dior/JPEGImages-trainval
Annotation path: datasets/dior/dior_mini_ann.json
2025-05-19 21:44:20,596 [INFO] save couning dir: ./object_counts/dior_mini/Qwen_open_vocabulary
2025-05-19 21:44:20,596 [INFO] output process time path: ./object_counts/Qwen_dior_mini_open_vocabulary_runtime.json
2025-05-19 21:44:34,193 [INFO] Counting results of 09100.jpg
2025-05-19 21:44:34,193 [INFO] 6.917428255081177s
2025-05-19 21:44:34,193 [INFO] ```json
{
    "airplane": 0,
    "airport": 0,
    "baseball field": 0,
    "basketball court": 0,
    "bridge": 1,
    "chimney": 0,
    "expressway service area": 0,
    "expressway toll station": 0,
    "dam": 0,
    "golf field": 0,
    "ground track field": 0,
    "harbor": 0,
    "overpass": 0,
    "ship": 0,
    "stadium": 0,
    "storage tank": 0,
    "tennis court": 0,
    "train station": 0,
    "vehicle": 0,
    "windmill": 0
}
```
2025-05-19 21:44:34,193 [INFO] output_token_count: 172
2025-05-19 21:44:34,193 [INFO] pred_counts: {'airplane': 0, 'airport': 0, 'baseball field': 0, 'basketball court': 0, 'bridge': 1, 'chimney': 0, 'expressway service area': 0, 'expressway toll station': 0, 'dam': 0, 'golf field': 0, 'ground track field': 0, 'harbor': 0, 'overpass': 0, 'ship': 0, 'stadium': 0, 'storage tank': 0, 'tennis court': 0, 'train station': 0, 'vehicle': 0, 'windmill': 0}
2025-05-19 21:44:39,989 [INFO] Counting results of 06796.jpg
2025-05-19 21:44:39,989 [INFO] 5.772407531738281s
2025-05-19 21:44:39,989 [INFO] ```json
{
  "airplane": 0,
  "airport": 0,
  "baseball field": 0,
  "basketball court": 1,
  "bridge": 0,
  "chimney": 0,
  "expressway service area": 0,
  "expressway toll station": 0,
  "dam": 0,
  "golf field": 0,
  "ground track field": 0,
  "harbor": 0,
  "overpass": 0,
  "ship": 0,
  "stadium": 0,
  "storage tank": 0,
  "tennis court": 2,
  "train station": 0,
  "vehicle": 1,
  "windmill": 0
}
```
2025-05-19 21:44:39,989 [INFO] output_token_count: 172
2025-05-19 21:44:39,990 [INFO] pred_counts: {'airplane': 0, 'airport': 0, 'baseball field': 0, 'basketball court': 1, 'bridge': 0, 'chimney': 0, 'expressway service area': 0, 'expressway toll station': 0, 'dam': 0, 'golf field': 0, 'ground track field': 0, 'harbor': 0, 'overpass': 0, 'ship': 0, 'stadium': 0, 'storage tank': 0, 'tennis court': 2, 'train station': 0, 'vehicle': 1, 'windmill': 0}
2025-05-19 21:44:45,794 [INFO] Counting results of 09938.jpg
2025-05-19 21:44:45,794 [INFO] 5.796191930770874s
2025-05-19 21:44:45,794 [INFO] ```json
{
  "airplane": 0,
  "airport": 0,
  "baseball field": 0,
  "basketball court": 1,
  "bridge": 0,
  "chimney": 0,
  "expressway service area": 0,
  "expressway toll station": 0,
  "dam": 0,
  "golf field": 0,
  "ground track field": 0,
  "harbor": 0,
  "overpass": 0,
  "ship": 0,
  "stadium": 0,
  "storage tank": 0,
  "tennis court": 0,
  "train station": 0,
  "vehicle": 14,
  "windmill": 0
}
```
2025-05-19 21:44:45,794 [INFO] output_token_count: 173
2025-05-19 21:44:45,795 [INFO] pred_counts: {'airplane': 0, 'airport': 0, 'baseball field': 0, 'basketball court': 1, 'bridge': 0, 'chimney': 0, 'expressway service area': 0, 'expressway toll station': 0, 'dam': 0, 'golf field': 0, 'ground track field': 0, 'harbor': 0, 'overpass': 0, 'ship': 0, 'stadium': 0, 'storage tank': 0, 'tennis court': 0, 'train station': 0, 'vehicle': 14, 'windmill': 0}
2025-05-19 21:44:51,291 [INFO] Counting results of 06486.jpg
2025-05-19 21:44:51,291 [INFO] 5.485745668411255s
2025-05-19 21:44:51,291 [INFO] ```json
{
    "airport": 0,
    "baseball field": 0,
    "basketball court": 0,
    "bridge": 0,
    "chimney": 0,
    "expressway service area": 0,
    "expressway toll station": 0,
    "dam": 0,
    "golf field": 0,
    "ground track field": 0,
    "harbor": 0,
    "overpass": 0,
    "ship": 0,
    "stadium": 0,
    "storage tank": 4,
    "tennis court": 0,
    "train station": 0,
    "vehicle": 5,
    "windmill": 0
}
```
2025-05-19 21:44:51,291 [INFO] output_token_count: 164
2025-05-19 21:44:51,291 [INFO] pred_counts: {'airport': 0, 'baseball field': 0, 'basketball court': 0, 'bridge': 0, 'chimney': 0, 'expressway service area': 0, 'expressway toll station': 0, 'dam': 0, 'golf field': 0, 'ground track field': 0, 'harbor': 0, 'overpass': 0, 'ship': 0, 'stadium': 0, 'storage tank': 4, 'tennis court': 0, 'train station': 0, 'vehicle': 5, 'windmill': 0}
